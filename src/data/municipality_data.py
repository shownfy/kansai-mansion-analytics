"""市区町村データモジュール

市区町村別の平均単価データを提供する。
データソース: 国土交通省 不動産取引価格情報（2020年以降、50件以上）
"""
from __future__ import annotations

# 市区町村別の平均単価（円/㎡）
MUNICIPALITY_AVG_PRICES: dict[str, int] = {
    "三島郡島本町": 288892,
    "三田市": 203497,
    "乙訓郡大山崎町": 149105,
    "亀岡市": 219640,
    "交野市": 237702,
    "京田辺市": 302920,
    "京都市上京区": 541360,
    "京都市下京区": 642643,
    "京都市中京区": 731923,
    "京都市伏見区": 300159,
    "京都市北区": 374999,
    "京都市南区": 462879,
    "京都市右京区": 398988,
    "京都市山科区": 295709,
    "京都市左京区": 531159,
    "京都市東山区": 605094,
    "京都市西京区": 299742,
    "伊丹市": 345334,
    "八尾市": 326459,
    "八幡市": 182488,
    "加古川市": 172889,
    "北葛城郡王寺町": 308055,
    "向日市": 496232,
    "吹田市": 435052,
    "和歌山市": 211656,
    "和泉市": 217347,
    "四條畷市": 248077,
    "城陽市": 348730,
    "堺市中区": 211144,
    "堺市北区": 353517,
    "堺市南区": 232270,
    "堺市堺区": 320660,
    "堺市東区": 249103,
    "堺市西区": 310828,
    "大和郡山市": 209132,
    "大和高田市": 169719,
    "大東市": 320827,
    "大津市": 308446,
    "大阪市中央区": 756617,
    "大阪市住之江区": 270462,
    "大阪市住吉区": 385247,
    "大阪市北区": 807511,
    "大阪市城東区": 440094,
    "大阪市大正区": 443092,
    "大阪市天王寺区": 640741,
    "大阪市平野区": 302307,
    "大阪市旭区": 335006,
    "大阪市東住吉区": 393913,
    "大阪市東成区": 546037,
    "大阪市東淀川区": 411665,
    "大阪市此花区": 390211,
    "大阪市浪速区": 726096,
    "大阪市淀川区": 456433,
    "大阪市港区": 495648,
    "大阪市生野区": 330247,
    "大阪市福島区": 696569,
    "大阪市西区": 695780,
    "大阪市西成区": 321620,
    "大阪市西淀川区": 383271,
    "大阪市都島区": 506591,
    "大阪市阿倍野区": 557109,
    "大阪市鶴見区": 413837,
    "大阪狭山市": 128530,
    "天理市": 182255,
    "奈良市": 263754,
    "姫路市": 209850,
    "宇治市": 272810,
    "守口市": 370433,
    "守山市": 241094,
    "宝塚市": 300804,
    "富田林市": 174634,
    "寝屋川市": 263558,
    "尼崎市": 378242,
    "岩出市": 68144,
    "岸和田市": 212552,
    "川西市": 258895,
    "川辺郡猪名川町": 145916,
    "彦根市": 207932,
    "摂津市": 408572,
    "明石市": 246127,
    "木津川市": 231437,
    "東大阪市": 282776,
    "松原市": 232184,
    "枚方市": 271422,
    "柏原市": 207258,
    "栗東市": 302035,
    "桜井市": 146199,
    "橿原市": 204998,
    "池田市": 338095,
    "河内長野市": 130337,
    "泉佐野市": 213666,
    "泉南市": 89080,
    "泉南郡熊取町": 126790,
    "泉大津市": 233374,
    "生駒市": 234095,
    "相楽郡精華町": 261761,
    "神戸市中央区": 613150,
    "神戸市兵庫区": 483865,
    "神戸市北区": 131067,
    "神戸市垂水区": 220768,
    "神戸市東灘区": 418320,
    "神戸市灘区": 413324,
    "神戸市西区": 271328,
    "神戸市長田区": 301429,
    "神戸市須磨区": 229231,
    "箕面市": 299363,
    "羽曳野市": 206380,
    "芦屋市": 425434,
    "茨木市": 359442,
    "草津市": 416245,
    "藤井寺市": 254119,
    "西宮市": 439989,
    "豊中市": 416452,
    "貝塚市": 132963,
    "近江八幡市": 274685,
    "野洲市": 263711,
    "長岡京市": 326071,
    "長浜市": 261614,
    "門真市": 298405,
    "阪南市": 119654,
    "香芝市": 250926,
    "高槻市": 401062,
    "高石市": 243617,
}

# 府県別のデフォルト平均単価（市区町村データがない場合のフォールバック）
PREFECTURE_AVG_PRICES: dict[str, int] = {
    "大阪府": 450000,
    "京都府": 420000,
    "兵庫県": 350000,
    "奈良県": 250000,
    "滋賀県": 300000,
    "和歌山県": 200000,
}

DEFAULT_AVG_PRICE = 350000  # デフォルト値


def get_municipality_avg_price(
    municipality: str | None = None,
    prefecture: str | None = None,
) -> int:
    """市区町村の平均単価を取得

    市区町村 → 府県 → デフォルトの順でフォールバック

    Args:
        municipality: 市区町村名（例: "伊丹市"）
        prefecture: 府県名（例: "兵庫県"）

    Returns:
        平均単価（円/㎡）
    """
    # 市区町村の平均単価を優先
    if municipality and municipality in MUNICIPALITY_AVG_PRICES:
        return MUNICIPALITY_AVG_PRICES[municipality]

    # 府県別平均単価にフォールバック
    if prefecture and prefecture in PREFECTURE_AVG_PRICES:
        return PREFECTURE_AVG_PRICES[prefecture]

    return DEFAULT_AVG_PRICE
